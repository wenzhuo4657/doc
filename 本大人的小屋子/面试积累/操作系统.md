
# 死锁 死锁的必要条件 如何预防

死锁：两个以上的线程互相持有并等待对方的资源，所在成的无限等待。

死锁发生的四个必要条件是
1，互斥：资源只能被一个线程拥有
2，占有并等待：
3，不可抢占：如果一个资源被某个线程获取，那么其他线程只能等待该线程释放才能获取
4，循环等待：- 存在一个线程等待的循环链，每个线程都在等待下一个线程所占有的资源。



预防死锁：
破坏四个必要条件，互斥、不可抢占属于资源的特性不可被破坏，所以只能破坏剩余两个。

占有等待：一次性获取
循环等待：获取资源时，进行有序分配或者通过资源分配图检测是否会发生环路。


## select/poll和epoll

基本概念：操作系统中的socket链接本质上是一个文件，进程通过打开链接这些文件来获取通信，可以检测链接的行为视为io读取，并通过读取内容来判断socket链接的状态。

select/poll:会轮训所有io文件，查看哪些需要处理
epoll:基于操作系统的io通知机制，维护一个活跃链接的队列，当事件来临时会主动通知监听该链接的进程。


## 是僵尸进程和孤儿进程：
僵尸进程：一个进程使用 fork 创建子进程，如果子进程退出，而父进程并没有调用 wait 或 waitpid 获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中，这种进程称之为僵死进程。

孤儿进程：一个父进程退出，而它的一个或多个子进程还在运行，那么这些子进程将成为孤儿进程。孤儿进程将被 init 进程(进程号为1)所收养，并由 init 进程对它们完成状态收集工作。